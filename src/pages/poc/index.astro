---
import PrimaryLayout from "@/layouts/PrimaryLayout.astro";

const poc = [
  {
    name: "One - Props + Callbacks",
    path: "poc-one",
    complexity: "‚≠ê",
    complexityLabel: "Simple",
    performance: "üü¢",
    performanceLabel: "Excellente",
    recommendation: "Petites apps, hi√©rarchie peu profonde",
    description:
      "Pattern le plus simple : le composant parent g√®re l'√©tat avec $state et passe les donn√©es via props aux enfants. Les enfants remontent les changements via callbacks. Id√©al pour les petites applications.",
    techDetails:
      "√âtat local dans parent, props descendantes, callbacks remontants",
    pros: "Facile √† comprendre, explicite",
    cons: "Prop drilling, verbeux si profondeur importante",
  },
  {
    name: "Two - Derived Store",
    path: "poc-two",
    complexity: "‚≠ê‚≠ê",
    complexityLabel: "Mod√©r√©",
    performance: "üü°",
    performanceLabel: "Bonne",
    recommendation: "Apps moyennes, √©tat global partag√©",
    description:
      "Pattern Svelte classique (v3/4) utilisant writable() et derived(). Les composants s'abonnent automatiquement avec la syntaxe $. √âtat global partag√© entre composants sans prop drilling.",
    techDetails: "writable, derived, auto-subscription avec $",
    pros: "√âprouv√©, d√©coupl√©, r√©actif",
    cons: "Global scope, legacy dans Svelte 5",
  },
  {
    name: "Three - Store (Runes)",
    path: "poc-three",
    complexity: "‚≠ê‚≠ê‚≠ê",
    complexityLabel: "Mod√©r√©+",
    performance: "üü¢",
    performanceLabel: "Excellente",
    recommendation: "‚≠ê RECOMMAND√â pour Svelte 5",
    description:
      "Store moderne avec les nouvelles runes Svelte 5 ($state, $derived). Encapsule l'√©tat dans une fonction qui retourne des getters r√©actifs. Alternative moderne aux stores classiques.",
    techDetails: "$state, $derived, fonction factory, getters",
    pros: "Moderne (Svelte 5), performant, scopable",
    cons: "Syntaxe getters n√©cessaire",
  },
  {
    name: "Four - Context API",
    path: "poc-four",
    complexity: "‚≠ê‚≠ê‚≠ê",
    complexityLabel: "Interm√©diaire",
    performance: "üü¢",
    performanceLabel: "Excellente",
    recommendation: "UI libraries, th√®mes, sous-arbres",
    description:
      "Utilise setContext/getContext pour partager l'√©tat dans l'arbre de composants. √âvite le prop drilling en rendant les donn√©es disponibles √† tous les descendants sans passage explicite de props.",
    techDetails: "setContext, getContext, contexte implicite",
    pros: "Pas de prop drilling, scop√© √† l'arbre",
    cons: "Implicite, couplage parent-enfant",
  },
  {
    name: "Five - Composable/Hook",
    path: "poc-five",
    complexity: "‚≠ê‚≠ê‚≠ê‚≠ê",
    complexityLabel: "Avanc√©",
    performance: "üü¢",
    performanceLabel: "Excellente",
    recommendation: "Logique r√©utilisable, tests unitaires",
    description:
      "Pattern inspir√© de React hooks et Vue composables. Fonction useFilters() r√©utilisable qui retourne √©tat et m√©thodes. Excellente r√©utilisabilit√© et composition de logiques.",
    techDetails: "Fonction composable, retour d'objet r√©actif, pattern hooks",
    pros: "Tr√®s r√©utilisable, testable, composable",
    cons: "N√©cessite passage explicite entre composants",
  },
  {
    name: "Six - Classe .svelte.ts",
    path: "poc-six",
    complexity: "‚≠ê‚≠ê‚≠ê‚≠ê",
    complexityLabel: "Avanc√©",
    performance: "üü°",
    performanceLabel: "Bonne",
    recommendation: "Logique m√©tier complexe, OOP",
    description:
      "Approche orient√©e objet avec une classe TypeScript utilisant les runes. Encapsulation compl√®te de la logique m√©tier. Permet d'instancier plusieurs gestionnaires ind√©pendants. Tr√®s testable.",
    techDetails:
      "Classe ES6, $state/$derived, m√©thodes publiques, instanciable",
    pros: "OOP, encapsul√©, multiple instances",
    cons: "Plus verbeux, paradigme diff√©rent",
  },
  {
    name: "Seven - Render Props/Slots",
    path: "poc-seven",
    complexity: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",
    complexityLabel: "Expert",
    performance: "üü¢",
    performanceLabel: "Excellente",
    recommendation: "Composants r√©utilisables, libraries",
    description:
      "Pattern avanc√© utilisant les Snippets Svelte 5 pour l'inversion de contr√¥le. Le composant FilterProvider expose l'√©tat via un slot avec props. Maximum de flexibilit√© et d√©couplage.",
    techDetails: "Snippet, render props, inversion de contr√¥le, slot props",
    pros: "Maximum de flexibilit√©, d√©couplage total",
    cons: "Syntaxe complexe, courbe d'apprentissage",
  },
];
---

<PrimaryLayout>
  <div class="place-self-center">
    <div class="flex flex-col mx-auto mb-20 p-4 max-w-6xl">
      <h1 class="mb-6 font-bold text-4xl">
        Patterns de Gestion d'√âtat - Svelte 5
      </h1>

      <div class="bg-blue-50 dark:bg-blue-900/20 mb-8 p-4 rounded-lg">
        <h2 class="mb-2 font-semibold text-xl">üéØ 7 Approches Compar√©es</h2>
        <p class="text-gray-700 dark:text-gray-300 text-sm">
          D√©monstration de 7 patterns pour g√©rer l'√©tat et le filtrage de
          donn√©es, du plus simple au plus avanc√©. Chaque impl√©mentation r√©sout
          le m√™me probl√®me : filtrer une liste d'items par cat√©gorie.
        </p>
      </div>

      <!-- Tableau comparatif -->
      <div
        class="bg-white dark:bg-gray-900 shadow-lg mb-8 p-6 border dark:border-gray-700 rounded-xl overflow-x-auto"
      >
        <h2 class="mb-4 font-bold text-2xl">üìä Tableau Comparatif</h2>
        <table class="w-full text-sm">
          <thead>
            <tr class="dark:border-gray-700 border-b-2">
              <th class="px-4 py-2 font-bold text-left">Pattern</th>
              <th class="px-4 py-2 font-bold text-center">Complexit√©</th>
              <th class="px-4 py-2 font-bold text-center">Performance</th>
              <th class="px-4 py-2 font-bold text-left">Recommand√© pour</th>
              <th class="px-4 py-2 font-bold text-left">Avantages</th>
              <th class="px-4 py-2 font-bold text-left">Inconv√©nients</th>
            </tr>
          </thead>
          <tbody>
            {
              poc.map((item, index) => (
                <tr
                  class={`border-b dark:border-gray-800 ${index % 2 === 0 ? "bg-gray-50 dark:bg-gray-800/50" : ""}`}
                >
                  <td class="px-4 py-3">
                    <a
                      href={`/poc/${item.path}`}
                      class="font-semibold text-blue-600 dark:text-blue-400 hover:underline"
                    >
                      {item.name}
                    </a>
                  </td>
                  <td class="px-4 py-3 text-center whitespace-nowrap">
                    <span class="inline-block">{item.complexity}</span>
                    <br />
                    <span class="text-gray-500 dark:text-gray-400 text-xs">
                      {item.complexityLabel}
                    </span>
                  </td>
                  <td class="px-4 py-3 text-center whitespace-nowrap">
                    <span class="inline-block text-xl">{item.performance}</span>
                    <br />
                    <span class="text-gray-500 dark:text-gray-400 text-xs">
                      {item.performanceLabel}
                    </span>
                  </td>
                  <td class="px-4 py-3">
                    <span class="bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded font-medium text-blue-700 dark:text-blue-300 text-xs">
                      {item.recommendation}
                    </span>
                  </td>
                  <td class="px-4 py-3 text-green-700 dark:text-green-400 text-xs">
                    ‚úì {item.pros}
                  </td>
                  <td class="px-4 py-3 text-orange-700 dark:text-orange-400 text-xs">
                    ‚ö† {item.cons}
                  </td>
                </tr>
              ))
            }
          </tbody>
        </table>
      </div>

      <!-- Liste des patterns avec descriptions d√©taill√©es -->
      <h2 class="mb-4 font-bold text-2xl">üîç D√©tails des Patterns</h2>
      <div class="space-y-4">
        {
          poc.map((item) => (
            <a
              href={`/poc/${item.path}`}
              class="block hover:shadow-lg p-5 border hover:border-blue-400 dark:hover:border-blue-600 rounded-xl transition-all"
            >
              <div class="flex justify-between items-start mb-3">
                <h3 class="font-bold text-blue-600 dark:text-blue-400 text-xl hover:underline">
                  {item.name}
                </h3>
                <div class="flex gap-2 ml-4">
                  <span class="bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full font-medium text-xs whitespace-nowrap">
                    {item.complexity} {item.complexityLabel}
                  </span>
                  <span class="bg-blue-100 dark:bg-blue-900/30 px-3 py-1 rounded-full font-medium text-xs whitespace-nowrap">
                    {item.performance} {item.performanceLabel}
                  </span>
                </div>
              </div>
              <div class="bg-blue-50 dark:bg-blue-900/20 mb-3 px-3 py-2 rounded-lg">
                <span class="font-semibold text-blue-900 dark:text-blue-200 text-xs">
                  üí° Recommand√© pour : {item.recommendation}
                </span>
              </div>
              <p class="mb-3 text-gray-700 dark:text-gray-300 text-sm leading-relaxed">
                {item.description}
              </p>
              <div class="gap-4 grid grid-cols-2 mt-3">
                <div class="bg-green-50 dark:bg-green-900/20 p-2 rounded">
                  <span class="text-green-700 dark:text-green-400 text-xs">
                    ‚úì {item.pros}
                  </span>
                </div>
                <div class="bg-orange-50 dark:bg-orange-900/20 p-2 rounded">
                  <span class="text-orange-700 dark:text-orange-400 text-xs">
                    ‚ö† {item.cons}
                  </span>
                </div>
              </div>
            </a>
          ))
        }
      </div>

      <div
        class="bg-linear-to-r from-purple-50 dark:from-purple-900/20 to-blue-50 dark:to-blue-900/20 mt-8 p-6 border border-purple-200 dark:border-purple-800 rounded-xl"
      >
        <h3 class="mb-3 font-bold text-purple-900 dark:text-purple-100 text-xl">
          üìñ Documentation Compl√®te
        </h3>
        <p class="mb-3 text-gray-700 dark:text-gray-300 text-sm">
          Pour une analyse d√©taill√©e avec tableaux comparatifs,
          avantages/inconv√©nients et recommandations par cas d'usage :
        </p>
        <a
          href="/poc/pattern"
          class="inline-block bg-purple-600 hover:bg-purple-700 dark:bg-purple-500 dark:hover:bg-purple-600 px-4 py-2 rounded-lg font-semibold text-white text-sm transition-colors"
        >
          üìÑ Voir PATTERNS_COMPARISON.md
        </a>
      </div>
    </div>
  </div>
</PrimaryLayout>
